<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!--Conexión con Bootstrap-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEAg3QhqLMpG8r+8fhAXLRk2vvoC2f3B09zVXn8CA5QIVfZOJ3BCsw2P0p/We" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css" >
    <title>Ciudadanos de 4 patas</title>
</head>
<body class="index">
    <div class="text-center">
        <h1>Ciudadanos de 4 patas
            <img src="Img/wlcome.gif" width="90" height="90">
        </h1>
    </div>
    <div class="container">
        <div class="d-grid justify-content-center align-items-center" >
            <div class="flotante2">
                <div class="d-grid gap-1">
                    <h4>Bienvenido a Ciudadano de 4 patas</h4>
                    <p>Por favor diligencie los siguentes campos</p>
                </div>
                <form class="needs-validation"  action="creadted-servlet"  method="post" novalidate>
                    <div class="form-group">
                        <label  class="mb-2 mr-sm-2">Nombre de Usuario</label>
                        <input id="username-input-crear" type="text" class="form-control mb-2 mr-sm-2" name="username"required/>
                        <div class="valid-feedback">Validado.</div>
                        <div id="username-error" class="invalid-feedback" value="Por favor llene este campo."></div>
                    </div>
                    <div class="form-group">
                        <label class="mb-2 mr-sm-2">Contraseña:</label>
                        <input id="pw-input-crear" type="password" class="form-control mb-2 mr-sm-2" name="password"required/>
                        <div class="valid-feedback">Validado.</div>
                        <div class="invalid-feedback">Por favor llene este campo.</div>
                    </div>
                    <div class="form-group">
                        <label class="mb-2 mr-sm-2">Validar Contraseña:</label>
                        <input id="pw2-input-crear" type="password" class="form-control mb-2 mr-sm-2" name="password2"required/>
                        <div class="valid-feedback">Validado.</div>
                        <div id="psw1-error" class="invalid-feedback" value="Por favor llene este campo."></div>
                    </div>
                    <div class="form-group">
                        <label class="mb-2 mr-sm-2">Email:</label>
                        <input id="email-input-crear" type="email" class="form-control mb-2 mr-sm-2" name="email"required/>
                        <div class="valid-feedback">Validado.</div>
                        <div id="psw-error" class="invalid-feedback" value="Por favor llene este campo."></div>                    </div>
                    <div class="form-group">
                        <label class="mb-2 mr-sm-2">Role:</label>
                        <select id="role-input-crear" name="role" required>
                            <option></option>
                            <option>Owner</option>
                            <option>Vet</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="mb-2 mr-sm-2">Nombre Propietario/ Nombre Veterinaria:</label>
                        <input id="name-input-crear" type="text" class="form-control mb-2 mr-sm-2" name="name"required/>
                        <div class="valid-feedback">Validado.</div>
                        <div class="invalid-feedback">Por favor llene este campo.</div>
                    </div>
                    <div class="form-group">
                        <label class="mb-2 mr-sm-2">Direccion:</label>
                        <input id="address-input-crear" type="text" class="form-control mb-2 mr-sm-2" name="address"required/>
                        <div class="valid-feedback">Validado.</div>
                        <div class="invalid-feedback">Por favor llene este campo.</div>
                    </div>
                    <div class="form-group">
                        <label  class="mb-2 mr-sm-2">Localidad:</label>
                        <select id="neightbor-input-crear" name="neighborhood" required>
                            <option></option>
                            <option>A. NARINO</option>
                            <option>B. UNIDOS</option>
                            <option>BOSA</option>
                            <option>C. BOLIVAR</option>
                            <option>CHAPINERO</option>
                            <option>ENGATIVA</option>
                            <option>FONTIBON</option>
                            <option>KENNEDY</option>
                            <option>LA CANDELARIA</option>
                            <option>LOS MARTIRES</option>
                            <option>P. ARANDA</option>
                            <option>R. URIBE</option>
                            <option>SAN CRISTOBAL</option>
                            <option>SANTA FE</option>
                            <option>SUBA</option>
                            <option>SUMAPAZ</option>
                            <option>TEUSAQUILLO</option>
                            <option>TUNJUELITO</option>
                            <option>USAQUEN</option>
                            <option>USME</option>
                        </select>
                        <div class="valid-feedback">Validado.</div>
                        <div class="invalid-feedback">Por favor llene este campo.</div>
                    </div>
                    <div>
                        <input class="botons1" type="submit" value="Sing in"></input>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script>

        (function() {
            const forms = document.getElementsByClassName('needs-validation');
            const validation = Array.prototype.filter.call(forms, function (form) {
                form.addEventListener('submit', function (event) {
                    if (form.checkValidity() === false) {
                        console.log(form.checkValidity())
                        event.preventDefault();
                        event.stopPropagation();
                    } else if (form.checkValidity() === true) {
                        function handleSunmit(event) {
                            let username = document.getElementById("username-input-crear").value
                            let psw1 = document.getElementById("pw-input-crear").value
                            let psw2 = document.getElementById("pw2-input-crear").value
                            let user = new UserAppService();
                            for (var i = 0; i < user.listUsers().size(); i++) {
                                if (user.listUsers().get(i).getUsername().equalsIgnoreCase(username)) {
                                    document.getElementById("username-error").setAttribute("value", "nombre de usuario ya existe")
                                    event.preventDefault();
                                    event.stopPropagation();
                                }
                            }
                            if (!psw1.equals(psw2)) {
                                document.getElementById("psw1-error").setAttribute("value", "Las contraseñas no coinciden")
                                document.getElementById("psw2-error").setAttribute("value", "Las contraseñas no coinciden")
                                event.preventDefault();
                                event.stopPropagation();
                            }
                        }
                    }
                    ;
                    form.classList.add('was-validated');
                }, false);
            });

        })();

    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="es">

    <head>
        <meta charset="UTF-8">
        <title>Ciudadanos de 4 Patas</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
        <link rel="stylesheet" href="style.css" >
        <style>
            body {font-family: Arial, Helvetica, sans-serif;}
            * {box-sizing: border-box;}
            /* Button used to open the chat form - fixed at the bottom of the page */
            .open-button {
                background-color: #555;
                color: white;
                padding: 16px 20px;
                border: none;
                cursor: pointer;
                opacity: 0.8;
                position: fixed;
                bottom: 23px;
                right: 28px;
                width: 280px;
            }

            /* The popup chat - hidden by default */
            .chat-popup {
                display: none;
                position: fixed;
                bottom: 0;
                right: 15px;
                border: 3px solid #f1f1f1;
                z-index: 9;
            }

            /* Add styles to the form container */
            .table-container {
                max-width: 300px;
                padding: 10px;
                background-color: white;
            }

            /* Full-width textarea */
            .table-container textarea {
                width: 100%;
                padding: 15px;
                margin: 5px 0 22px 0;
                border: none;
                background: #f1f1f1;
                resize: none;
                min-height: 200px;
            }

            /* Full-width input */
            .table-container input {
                width: 100%;
                padding: 15px;
                margin: 5px 0 22px 0;
                border: none;
                background: #f1f1f1;
                resize: none;
                min-height: 200px;
            }


            /* When the textarea gets focus, do something */
            .table-container textarea:focus {
                background-color: #ddd;
                outline: none;
            }

            /* When the input gets focus, do something */
            .table-container input:focus {
                background-color: #ddd;
                outline: none;
            }

            /* Set a style for the submit/send button */
            .table-container .btn {
                background-color: #04AA6D;
                color: white;
                padding: 16px 20px;
                border: none;
                cursor: pointer;
                width: 100%;
                margin-bottom:10px;
                opacity: 0.8;
            }

            /* Add a red background color to the cancel button */
            .table-container .cancel {
                background-color: red;
            }

            /* Add some hover effects to buttons */
            .table-container .btn:hover, .open-button:hover {
                opacity: 1;
            }
        </style>
    </head>

    <body id="Body">

        <div class="container">
            <div class="text-center jumbotron" style="margin-bottom:0">
             <h1>Ciudadano de 4 Patas</h1>
             <p> Una campaña para identificar a todos
                estos miembros de nuestras familias como “Ciudadanos de 4 Patas”. Mediante un
                microchip que emite una radiofrecuencia, es posible identificar, registrar y realizar
                seguimiento a todas nuestras mascotas</p>
            </div>
        </div>

        <nav class="navbar navbar-expand-sm bg-dark navbar-dark">
            <img src="./Img/pata.png" style="margin-left:20px" width="75" height="75">
            <a class="navbar-brand" style="margin-left:20px">Bienvenid@</a>
            <b class="text-secondary">   Este es el formulario que debe diligenciar para registrar una nueva mascota</b>
            <button class="btn btn-secondary" id="edit-button">Editar</button>
            <button class="btn btn-secondary" id="case-button">Ver casos </button>
            <button class="btn btn-secondary" id="logout-button">Logout</button>
        </nav>
        <div class="container" style="margin-left: 10px">
            <div class="row">
                <div class="container-sm col-sm-6" style="margin-top:30px"> 
                    <div class="needs-validation"   novalidate>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2"> Nombre de la mascota:</label>
                            <input id="petname-input" type="text" class="form-control mb-2 mr-sm-2" placeholder="Nombre de la mascota" name="petname"required/>
                            <div class="valid-feedback">Validado.</div>
                            <div class="invalid-feedback">Por favor llene este campo.</div>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2"> Numero de Microchip de la mascota:</label>
                            <input id="petmicrochip-input" type="number" min="0" max="10000000000000" class="form-control mb-2 mr-sm-2" placeholder="Microchip" name="petname"/>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Especie:</label>
                            <select id="petspecies-input"required>
                                <option></option>
                                <option>Perro</option>
                                <option>Gato</option>
                            </select>
                            <div class="valid-feedback">Validado.</div>
                            <div class="invalid-feedback">Por favor llene este campo.</div>
                        </div>
                        <label  class="mb-2 mr-sm-2">Raza:</label>
                        <select id="dograza-input" disabled="disabled"required>
                            <option></option>
                        </select>
                        <select id="catraza-input" disabled="disabled"required>
                            <option></option>
                        </select>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Sexo:</label>
                            <select id="petsex-input"required>
                                <option></option>
                                <option>Macho</option>
                                <option>Hembra</option>
                            </select>
                            <div class="valid-feedback">Validado.</div>
                            <div class="invalid-feedback">Por favor llene este campo.</div>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Tamaño:</label>
                            <select id="petsize-input"required>
                                <option></option>
                                <option>Miniatura</option>
                                <option>Pequeño</option>
                                <option>Mediano</option>
                                <option>Grande</option>
                            </select>
                            <div class="valid-feedback">Validado.</div>
                            <div class="invalid-feedback">Por favor llene este campo.</div>
                        </div>
                        <form  action="propietario.html">
                            <div>
                                <br/>
                                <input type="file" id="imagen" name="imagensubida" accept="image/png, .jpeg, .jpg, image/gif">
                            </div>
                            <br/><br/>
                            <input id="petsave-button"  type="submit"  class="btn btn-outline-success" value="Guardar"/>
                            <input id="petclean-button" type="reset" class="btn btn-outline-danger"value="Limpiar" />
                        </form>
                    </div>
                </div>
                <div class="container col-sm-4" style="margin-top:30px">
                    <img id="dogimage" src="./Img/golden.jpg" class="rounded" alt="Cinque Terre" width="304" height="236">
                    <br/><br/>
                    <img id="catimage" src="./Img/gato.jpg" class="rounded" alt="Cinque Terre" width="304" height="236">
                </div>
            </div>            
            <br/><br/>
            <div class="container" style="margin-left:20px">
                <br/><br/>
                <div class="table-responsive col-sm-9 container">
                    <table class="table table-hover">
                        <thead class="thead-dark">
                        <tr>
                            <th class="column-header">Foto</th>
                            <th class="column-header">Id</th>
                            <th class="column-header">Nombre de la mascota</th>
                            <th class="column-header">Numero de Microchip de la mascota</th>
                            <th class="column-header">Especie</th>
                            <th class="column-header">Sexo</th>
                            <th class="column-header">Tamaño</th>
                            <th class="column-header">Localidad</th>
                            <th class="column-header">Acciones</th>
                        </tr>
                        </thead>
                        <tbody id="body-table">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="card-footer  bg-dark text-white" style="margin-top: 175px;">
            <br/><br/>
            <img src="./Img/logo-ub.png"  width="229" height="67">
            <p>David Real, Felipe Segura</p>
            <br/><br/>
        </div>
        <div class="modal" id="case1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2  class="modal-title">Este Formulario permite editar su localidad y direccion</h2>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Localidad:</label>
                            <select id="neightbor-edit">
                                <option></option>
                                <option>A_NARINO</option>
                                <option>B_UNIDOS</option>
                                <option>BOSA</option>
                                <option>C_BOLIVAR</option>
                                <option>CHAPINERO</option>
                                <option>ENGATIVA</option>
                                <option>FONTIBON</option>
                                <option>KENNEDY</option>
                                <option>LA_CANDELARIA</option>
                                <option>LOS_MARTIRES</option>
                                <option>P_ARANDA</option>
                                <option>R_URIBE</option>
                                <option>SAN_CRISTOBAL</option>
                                <option>SANTA_FE</option>
                                <option>SUBA</option>
                                <option>SUMAPAZ</option>
                                <option>TEUSAQUILLO</option>
                                <option>TUNJUELITO</option>
                                <option>USAQUEN</option>
                                <option>USME</option>
                            </select>

                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Direccion:</label>
                            <input id="address-edit" type="text" class="form-control mb-2 mr-sm-2" placeholder="Direccion"/>
                        </div>
                        <div class="modal-footer">
                            <button id="save-edit1" type="button" class="btn btn-success" data-dismiss="modal">Guardar</button>
                            <button id="close-edit1" type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal" id="case2">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2  class="modal-title">Este Formulario permite editar su Mascota</h2>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Id de la mascota(este campo no es editable):</label>
                            <input id="id-edit" type="number" min="0" max="10000000000000" class="form-control mb-2 mr-sm-2" placeholder="ID" name="petId"/>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Nombre de la mascota:</label>
                            <input id="petname-edit" type="text" class="form-control mb-2 mr-sm-2" placeholder="Nombre de la mascota" name="petname"required/>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Especie:</label>
                            <input id="specie-edit" type="text" class="form-control mb-2 mr-sm-2" placeholder="Especie" name="specie"required/>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Raza:</label>
                            <input id="raza-edit" type="text" class="form-control mb-2 mr-sm-2" placeholder="Raza" name="raza"required/>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Tamaño:</label>
                            <input id="size-edit" type="text" class="form-control mb-2 mr-sm-2" placeholder="Tamaño" name="size"required/>
                        </div>
                        <div class="modal-footer">
                            <button id="save-edit2" type="button" class="btn btn-success" data-dismiss="modal">Guardar</button>
                            <button id="close-edit2" type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal" id="case3">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2  class="modal-title">Ingresar nuevo caso</h2>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Id de la mascota:</label>
                            <input id="id-case" type="number" min="0" max="10000000000000" class="form-control mb-2 mr-sm-2" placeholder="Id" name="id_case"/>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Tipo:</label>
                            <input id="type-case" type="text" class="form-control mb-2 mr-sm-2" placeholder="Tipo" name="Tipo"required/>
                        </div>
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Descripcion:</label>
                            <input id="ds-case" type="text" class="form-control mb-2 mr-sm-2" placeholder="Descripcion" name="Descripcion"required/>
                        </div>
                        <div class="modal-footer">
                            <button id="save-edit3" type="button" class="btn btn-success" data-dismiss="modal">Guardar</button>
                            <button id="close-edit3" type="button" class="btn btn-danger" data-dismiss="modal">Cancelar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal" id="case4">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h2  class="modal-title">Aqui podra ver los casos de sus mascotas</h2>
                    </div>
                    <div class="modal-body">
                        <div class="form-group">
                            <label  class="mb-2 mr-sm-2">Id de la mascota:</label>
                            <input id="id2-case" type="number" min="0" max="10000000000000" class="form-control mb-2 mr-sm-2" placeholder="Id" name="id_case"/>
                            <button id="case-table" type="button" class="btn btn-success" data-dismiss="modal">Cargar Tabla</button>
                        </div>
                        <br/><br/>
                        <div class="table-responsive col-sm-9 container">
                            <table class="table table-hover">
                                <thead class="thead-dark">
                                <tr>
                                    <th class="column-header"># Caso</th>
                                    <th class="column-header">Fecha</th>
                                    <th class="column-header">Tipo</th>
                                    <th class="column-header">Descripcion</th>
                                    <th class="column-header">Id mascota</th>
                                </tr>
                                </thead>
                                <tbody id="case-body">
                                </tbody>
                            </table>
                        </div>
                        <div class="modal-footer">
                            <button id="close-case" type="button" class="btn btn-danger" data-dismiss="modal">Cerrar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <button class="open-button" onclick="openChat();">Chat</button>
        <div class="chat-popup" id="myChat">
            <table class="table-container">
                <tr>
                    <td>
                        <h1>Chat</h1>
                        <textarea readonly="true" rows="5" cols="10" id="log"></textarea>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label><b>Message</b></label>
                        <input placeholder="Type message.." id="msg" required></input>
                    </td>
                </tr>
                <tr>
                    <td>
                        <button type="button" onclick="send();" class="btn">Send</button>
                        <button type="button" class="btn cancel" onclick="closeChat();">Close</button>
                    </td>
                </tr>
            </table>
        </div>
    <script>

        document.getElementById("save-edit1").onclick = function (){
            let user;
            const cookies = document.cookie.split(";");
            for (let i = 0; i < cookies.length; i++) {
                if (cookies[i].includes("username")) {
                    user = cookies[i].split("=")[1];
                }
            }
            let neigt =  document.getElementById("neightbor-edit").value;
            let address =  document.getElementById("address-edit").value;
            let edit ={
                owner :{
                    address: address,
                    neighborhood: neigt
                }
            }
            fetch('http://localhost:8080/Proyecto-Final-1.0-SNAPSHOT/api/user/'+user, {
                method: 'PUT',
                body: JSON.stringify(edit),
                headers: {
                    'Content-type': 'application/json; charset=UTF-8'
                }
            })
            case1.style.display = "none";
            case1.className="modal fade";

        }

        document.getElementById("save-edit2").onclick = function (){
            let pet_id = document.getElementById("id-edit").value;
            let pet_name = document.getElementById("petname-edit").value;
            let pet_specie = document.getElementById("specie-edit").value;
            let pet_raza = document.getElementById("raza-edit").value;
            let pet_size = document.getElementById("size-edit").value;
            let edit ={
                name:pet_name,
                species:pet_specie,
                race:pet_raza,
                size:pet_size
            }
            fetch('http://localhost:8080/Proyecto-Final-1.0-SNAPSHOT/api/users/pets/'+pet_id, {
                method: 'PUT',
                body: JSON.stringify(edit),
                headers: {
                    'Content-type': 'application/json; charset=UTF-8'
                }
            })
            case2.style.display = "none";
            case2.className="modal fade";
        }

        document.getElementById("save-edit3").onclick = function (){
            let owner;
            const cookies = document.cookie.split(";");
            for (let i = 0; i < cookies.length; i++) {
                if (cookies[i].includes("person_id=")) {
                    owner = cookies[i].split("=")[1];
                }
            }
            let pet_id = document.getElementById("id-case").value;
            let created_at = Date();
            let  type =  document.getElementById("type-case").value;
            let ds = document.getElementById("ds-case").value;
            let petcase={
                created_at: Date(),
                type: type,
                description: ds
            }
            fetch('http://localhost:8080/Proyecto-Final-1.0-SNAPSHOT/api/users/'+owner+'/pets/'+pet_id+'/petcase', {
                method: 'POST',
                body: JSON.stringify(petcase),
                headers: {
                    'Content-type': 'application/json; charset=UTF-8'
                }
            })
            case3.style.display = "none";
            case3.className="modal fade";
        }

        document.getElementById("case-table").onclick = function (){
            let pet_id = document.getElementById("id2-case").value;
            fetch('http://localhost:8080/Proyecto-Final-1.0-SNAPSHOT/api/petCases')
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    data.forEach((caso)=>{
                        if(caso.pet_id==pet_id){
                            let tr = document.createElement("tr")
                            let json={
                                numero: caso.case_id,
                                fecha : caso.created_at,
                                tipo : caso.type,
                                ds : caso.description,
                                id : caso.pet_id
                            }
                            Object.keys(json).forEach((key) => {
                                let td = document.createElement("td");
                                td.innerHTML = json[key];
                                tr.appendChild(td);
                            });
                            document.getElementById("case-body").appendChild(tr);
                        }

                    })
                });
        }

        let catBreeds = [];
        var rowId = 0;

        //Checks if the login is done
        if(document.cookie.length===0){
            window.location.href = location.href.replace("propietario.html","");
        }
        document.getElementById("logout-button").onclick = function (){
            document.cookie = "Rol = ; expires = "+Date();
            document.cookie = "username = ; expires = "+Date();
            window.location.href = location.href.replace("propietario.html","");
        };
        fetch('https://dog.ceo/api/breeds/list/all')
            .then(response => response.json())
            .then(data => {
                let petBreed = document.getElementById("dograza-input");
                Object.keys(data.message).map((breed) => {
                    let option = document.createElement("option");
                    option.innerHTML = breed;
                    petBreed.appendChild(option);
                });
            });

        fetch('https://api.thecatapi.com/v1/breeds')
            .then(response => response.json())
            .then(data => {
                catBreeds = data;
                let catBreed = document.getElementById("catraza-input");
                data.forEach((breed) => {
                    let option = document.createElement("option");
                    option.innerHTML = breed.name;
                    catBreed.appendChild(option);
                });
            });

        const case1 = document.getElementById("case1");
        const case2 = document.getElementById("case2");
        const case3 = document.getElementById("case3");
        const case4 = document.getElementById("case4");

        (function ()  {
            let user;
            const cookies = document.cookie.split(";");
            for (let i = 0; i < cookies.length; i++) {
                if (cookies[i].includes("username")) {
                    user = cookies[i].split("=")[1];
                }
            }
            fetch('http://localhost:8080/Proyecto-Final-1.0-SNAPSHOT/api/users/owner/' + (user))
                .then(response => response.json())
                .then(data => {
                    console.log(data);
                    document.cookie = "person_id=" + data.person_id;
                    document.cookie = "email="+data.email;
                    document.cookie = "name="+data.name;
                    document.cookie = "address="+data.address;
                    document.cookie = "neighborhood=" + data.neighborhood;
                });

            fetch('http://localhost:8080/Proyecto-Final-1.0-SNAPSHOT/api/pets')
                .then(response => response.json())
                .then(data => {
                    console.log(data)
                    data.forEach((pet) => {
                        console.log(pet.owner_id);
                        let neighbor;
                        let owner;
                        for (let i = 0; i < cookies.length; i++) {
                            if (cookies[i].includes("person_id=")) {
                                owner = cookies[i].split("=")[1];
                            }
                            if (cookies[i].includes("neighborhood=")) {
                                neighbor = cookies[i].split("=")[1];
                            }
                        }
                        console.log(owner);
                        if (owner == pet.owner_id) {
                            let tr = document.createElement("tr")
                            tr.setAttribute("id", "row-" + (rowId + 1));
                            let tdimg = document.createElement("td");
                            let img = document.createElement("img");
                            img.setAttribute("class", "rounded")
                            img.setAttribute("id", "img-" + (rowId + 1))
                            img.setAttribute("alt", "Cinque Terre")
                            img.setAttribute("width", "200")
                            img.setAttribute("height", "156")
                            img.setAttribute("src", "./uploads/" + pet.picture)
                            tdimg.appendChild(img);
                            tr.appendChild(tdimg);
                            let pets = {
                                idnum: pet.pet_id,
                                petname: pet.name,
                                microchipnum: pet.microchip,
                                petspecie: pet.species,
                                petsex: pet.sex,
                                petsize: pet.size,
                                neightborinput: neighbor
                            }
                            Object.keys(pets).forEach((key) => {
                                let td = document.createElement("td");
                                td.innerHTML = pets[key];
                                tr.appendChild(td);
                            });
                            let tdActions = document.createElement("td");

                            let input = document.createElement("input");
                            input.setAttribute("id", "delete-" + (rowId+1));
                            input.setAttribute("type", "button");
                            input.value = "Nuevo Caso";
                            input.onclick = function() {
                                case3.style.display = "block";
                                case3.style.paddingRight = "17px";
                                case3.className="modal fade show";
                            };

                            tdActions.appendChild(input);

                            let inputeditar = document.createElement("input");
                            inputeditar.setAttribute("id", "editar-" + (rowId+1));
                            inputeditar.setAttribute("type", "button");
                            inputeditar.setAttribute("data-toggle","modal" )
                            inputeditar.value = "Editar";


                            inputeditar.onclick = function() {
                                console.log("se leyo editar 1")
                                case2.style.display = "block";
                                case2.style.paddingRight = "17px";
                                case2.className="modal fade show";
                            }
                            tdActions.appendChild(inputeditar);
                            tr.appendChild(tdActions);
                            document.getElementById("body-table").appendChild(tr);

                           rowId++;
                        }
                    });

                })
        })();

        const form = document.querySelector('form');
        form.addEventListener('submit',handleSubmit)

        function handleSubmit(event) {
            event.preventDefault();
            const data = new FormData(event.target);
            const value = Object.fromEntries(data.entries());
            console.log({value});
            var owner;
            const cookies = document.cookie.split(";");
            for(let i =0; i<cookies.length; i++) {
                if (cookies[i].includes("person_id=")) {
                    owner = cookies[i].split("=")[1];
                }
            }
            let petname = document.getElementById("petname-input").value;
            let microchip = document.getElementById("petmicrochip-input").value;
            let species = document.getElementById("petspecies-input").value;
            let raza;
            if(species==="Perro"){
                raza =document.getElementById("dograza-input").value;
            }else if (species==="Gato"){
                raza =document.getElementById("catraza-input").value;
            }
            let sex = document.getElementById("petsex-input").value;
            let size = document.getElementById("petsize-input").value;
            let imagen = document.getElementById("imagen").value;
            let imname =imagen.split("\\")[2]
            console.log(imname)
            let pet = {
                microchip: microchip,
                name: petname,
                picture: imname,
                race: raza,
                sex: sex,
                size: size,
                species: species
            }
            fetch('http://localhost:8080/Proyecto-Final-1.0-SNAPSHOT/api/users/'+owner+'/pets', {
                method: 'POST',
                body: JSON.stringify(pet),
                headers: {
                    'Content-type': 'application/json; charset=UTF-8'
                }
            })
            const info = new FormData(event.target);
            fetch('multiPartServlet', {
                method: 'POST',
                body: info,

            })
            rowId++;
        }

        document.getElementById("close-edit1").onclick=function() {
            case1.style.display = "none";
            case1.className="modal fade";
        };

        document.getElementById("close-edit2").onclick=function() {
            case2.style.display = "none";
            case2.className="modal fade";
        };

        document.getElementById("close-edit3").onclick=function() {
            case3.style.display = "none";
            case3.className="modal fade";
        };

        document.getElementById("close-case").onclick=function() {
            case4.style.display = "none";
            case4.className="modal fade";
        };

        document.getElementById("petspecies-input").onclick = function(){
            let raza =document.getElementById("petspecies-input").value;
            if(raza=="Perro"){
                console.log("Perro")
                document.getElementById("dograza-input").removeAttribute("disabled")
                document.getElementById("catraza-input").setAttribute("disabled",true)
            }else if(raza=="Gato"){
                console.log("gato")
                document.getElementById("catraza-input").removeAttribute("disabled")
                document.getElementById("dograza-input").setAttribute("disabled",true)
            }
        };

        let editar = document.getElementById("edit-button");
        editar.onclick  = function() {
            console.log("se leyo editar 1")
            case1.style.display = "block";
            case1.style.paddingRight = "17px";
            case1.className="modal fade show";

        };

        let petcases = document.getElementById("case-button");
        petcases.onclick  = function() {
            console.log("se leyo editar 1")
            case4.style.display = "block";
            case4.style.paddingRight = "17px";
            case4.className="modal fade show";

        };

        //Chat Management
        var ws;

        //Open Chat
        function openChat() {
            document.getElementById("myChat").style.display = "block";

            var username = getCookie("username");
            var role = getCookie("Rol");

            var host = document.location.host;
            var pathname = document.location.pathname.split("/")[1];

            ws = new WebSocket("ws://" + host +"/"+ pathname + "/chat/"+role+"/"+ username);

            ws.onmessage = function(event) {
                var log = document.getElementById("log");
                console.log(event.data);
                var message = JSON.parse(event.data);
                log.innerHTML += message.from + " : " + message.content + "\n";
            };
        }
        //Send message
        function send() {
            var content = document.getElementById("msg").value;
            document.getElementById("msg").value = ""
            var json = JSON.stringify({
                "content": content
            });

            ws.send(json);
        }
        //Close chat
        function closeChat() {
            document.getElementById("myChat").style.display = "none";
        }
    </script>
    </body>
</html>